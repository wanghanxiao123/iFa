<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="description" content="iFlame: Interleaving Full and Linear Attention for Efficient Mesh Generation">
    <meta name="keywords" content="iFlame, Mesh Generation, Transformer, Linear Attention">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>iFlame: Interleaving Full and Linear Attention for Efficient Mesh Generation</title>

    <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

    <link rel="stylesheet" href="./static/css/bulma.min.css">
    <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
    <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
    <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
    <link rel="stylesheet" href="./static/css/index.css">
    <link rel="icon" href="./static/images/favicon.svg">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script defer src="./static/js/fontawesome.all.min.js"></script>
    <script src="./static/js/bulma-carousel.min.js"></script>
    <script src="./static/js/bulma-slider.min.js"></script>
    <script src="./static/js/index.js"></script>
</head>

<body>
    <section class="hero">
        <div class="hero-body">
            <div class="container is-max-desktop">
                <div class="columns is-centered">
                    <div class="column has-text-centered">
                        <h1 class="title is-1 publication-title">iFlame: Interleaving Full and Linear Attention for Efficient Mesh Generation</h1>
                        <div class="is-size-5 publication-authors">
                            <span class="author-block">
                                <a href="https://zhuofan.net">Zhuofan Xia</a><sup>1</sup>,</span>
                            <span class="author-block">
                                <a href="#">Biao Zhang</a><sup>2</sup>,</span>
                            <span class="author-block">
                                <a href="#">Weize Quan</a><sup>1</sup>,</span>
                            <span class="author-block">
                                <a href="#">Dong-Ming Yan</a><sup>1</sup>,</span>
                            <span class="author-block">
                                <a href="#">Peter Wonka</a><sup>2</sup>
                            </span>
                        </div>

                        <div class="is-size-5 publication-authors">
                            <span class="author-block"><sup>1</sup>CASIA,</span>
                            <span class="author-block"><sup>2</sup>KAUST</span>
                        </div>

                        <div class="column has-text-centered">
                            <div class="publication-links">
                                <!-- PDF Link. -->
                                <span class="link-block">
                                    <a href="#" class="external-link button is-normal is-rounded is-dark">
                                        <span class="icon">
                                            <i class="fas fa-file-pdf"></i>
                                        </span>
                                        <span>Paper</span>
                                    </a>
                                </span>
                                <!-- Code Link. -->
                                <span class="link-block">
                                    <a href="#" class="external-link button is-normal is-rounded is-dark">
                                        <span class="icon">
                                            <i class="fab fa-github"></i>
                                        </span>
                                        <span>Code</span>
                                    </a>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="section">
        <div class="container is-max-desktop">
            <!-- Abstract. -->
            <div class="columns is-centered has-text-centered">
                <div class="column is-four-fifths">
                    <h2 class="title is-3">Abstract</h2>
                    <div class="content has-text-justified">
                        <p>
                            This paper describes a novel transformer-based network architecture for large mesh generation. While attention-based models have demonstrated remarkable performance in mesh generation, their quadratic computational complexity limits scalability, particularly for high-resolution 3D data. Conversely, linear attention mechanisms offer lower computational costs but often struggle to capture long-range dependencies, resulting in suboptimal outcomes.
                        </p>
                        <p>
                            To address this trade-off, we propose an interleaving autoregressive mesh generation framework that combines the efficiency of linear attention with the expressive power of standard attention mechanisms. To further enhance efficiency and leverage the inherent structure of mesh representations, we integrate this interleaving approach into an hourglass architecture, which significantly boosts efficiency.
                        </p>
                        <p>
                            Our approach reduces training time while achieving performance comparable to pure attention-based models. To improve inference efficiency, we implemented...
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="hero is-light is-small">
        <div class="hero-body">
            <div class="container">
                <div id="mesh-pages">
                    <!-- We'll use just one page structure and reload meshes -->
                    <div class="mesh-page">
                        <div class="columns">
                            <div class="column is-3 render_wrapper_small">
                                <div id="mesh_1" class="render_div"></div>
                            </div>
                            <div class="column is-3 render_wrapper_small">
                                <div id="mesh_2" class="render_div"></div>
                            </div>
                            <div class="column is-3 render_wrapper_small">
                                <div id="mesh_3" class="render_div"></div>
                            </div>
                            <div class="column is-3 render_wrapper_small">
                                <div id="mesh_4" class="render_div"></div>
                            </div>
                        </div>
                        <div class="columns">
                            <div class="column is-3 render_wrapper_small">
                                <div id="mesh_5" class="render_div"></div>
                            </div>
                            <div class="column is-3 render_wrapper_small">
                                <div id="mesh_6" class="render_div"></div>
                            </div>
                            <div class="column is-3 render_wrapper_small">
                                <div id="mesh_7" class="render_div"></div>
                            </div>
                            <div class="column is-3 render_wrapper_small">
                                <div id="mesh_8" class="render_div"></div>
                            </div>
                        </div>
                        <div class="columns">
                            <div class="column is-3 render_wrapper_small">
                                <div id="mesh_9" class="render_div"></div>
                            </div>
                            <div class="column is-3 render_wrapper_small">
                                <div id="mesh_10" class="render_div"></div>
                            </div>
                            <div class="column is-3 render_wrapper_small">
                                <div id="mesh_11" class="render_div"></div>
                            </div>
                            <div class="column is-3 render_wrapper_small">
                                <div id="mesh_12" class="render_div"></div>
                            </div>
                        </div>
                        <div class="columns">
                            <div class="column is-3 render_wrapper_small">
                                <div id="mesh_13" class="render_div"></div>
                            </div>
                            <div class="column is-3 render_wrapper_small">
                                <div id="mesh_14" class="render_div"></div>
                            </div>
                            <div class="column is-3 render_wrapper_small">
                                <div id="mesh_15" class="render_div"></div>
                            </div>
                            <div class="column is-3 render_wrapper_small">
                                <div id="mesh_16" class="render_div"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Pagination controls -->
                    <div class="pagination-controls" style="text-align: center; margin-top: 20px;">
                        <button class="button is-small" onclick="changePage(1)">1</button>
                        <button class="button is-small" onclick="changePage(2)">2</button>
                        <button class="button is-small" onclick="changePage(3)">3</button>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 10px;">
                    <div id="page-info" style="margin-bottom: 5px;">Page 1 of 3</div>
                    Press <b>G</b> to toggle wireframe. Press <b>R</b> to reset view.
                </div>
            </div>
        </div>
    </section>

    <section class="section">
        <div class="container is-max-desktop">
            <!-- Method. -->
            <div class="columns is-centered">
                <div class="column is-full-width">
                    <h2 class="title is-3">Method</h2>
                    <div class="content has-text-justified">
                        <p>
                            Our method introduces an interleaving approach to mesh generation that combines the benefits of full attention and linear attention mechanisms. By strategically integrating these two attention types, we achieve both computational efficiency and high-quality results.
                        </p>
                        <p>
                            The key innovations of our approach include:
                        </p>
                        <ul>
                            <li>An interleaving autoregressive framework that alternates between full and linear attention</li>
                            <li>An hourglass architecture that leverages the inherent structure of mesh representations</li>
                            <li>Optimized training and inference pipelines for improved efficiency</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer class="footer">
        <div class="container">
            <div class="content has-text-centered">
                <a class="icon-link" href="#">
                    <i class="fas fa-file-pdf"></i>
                </a>
                <a class="icon-link" href="#" class="external-link" disabled>
                    <i class="fab fa-github"></i>
                </a>
            </div>
            <div class="columns is-centered">
                <div class="column is-8">
                    <div class="content">
                        <p>
                            This website is adapted from <a href="https://github.com/nerfies/nerfies.github.io">Nerfies</a>.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <script type="module">
        import * as THREE from 'three';

        import { PLYLoader } from './js/PLYLoader.js';
        import { OrbitControls } from './js/OrbitControls.js';
        
        // Initialize the dictionary to track div scenes
        let div_to_scene = {};
        for (let i = 1; i <= 16; i++) {
            div_to_scene["mesh_" + i] = {
                "geo": null,
                "color": null,
                "scene": null
            };
        }
        
        // Track orbit controls for each div
        let list_of_orbit_controls = [];
        
        // Define all model paths in an array
        const allModels = [
            // Page 1 (models 1-16)
            './models/objaverse/12.ply',
            './models/objaverse/22.ply',
            './models/objaverse/46.ply',
            './models/objaverse/63.ply',
            './models/objaverse/96.ply',
            './models/objaverse/97.ply',
            './models/objaverse/98.ply',
            './models/objaverse/100.ply',
            './models/objaverse/86.ply',
            './models/objaverse/76.ply',
            './models/objaverse/66.ply',
            './models/objaverse/120.ply',
            './models/objaverse/116.ply',
            './models/objaverse/125.ply',
            './models/objaverse/126.ply',
            './models/objaverse/127.ply',
            
            // Page 2 (models 17-32)
            './models/objaverse/146.ply',
            './models/objaverse/153.ply',
            './models/objaverse/154.ply',
            './models/objaverse/131.ply',
            './models/objaverse/134.ply',
            './models/objaverse/148.ply',
            './models/objaverse/149.ply',
            './models/objaverse/157.ply',
            './models/objaverse/167.ply',
            './models/objaverse/165.ply',
            './models/objaverse/174.ply',
            './models/objaverse/182.ply',
            './models/objaverse/180.ply',
            './models/objaverse/177.ply',
            './models/objaverse/232.ply',
            './models/objaverse/240.ply',
            
            // Page 3 (models 33-48)
            './models/objaverse/243.ply',
            './models/objaverse/205.ply',
            './models/objaverse/229.ply',
            './models/objaverse/196.ply',
            './models/objaverse/197.ply',
            './models/objaverse/195.ply',
            './models/objaverse/252.ply',
            './models/objaverse/250.ply',
            './models/objaverse/261.ply',
            './models/objaverse/262.ply',
            './models/objaverse/263.ply',
            './models/objaverse/271.ply',
            './models/objaverse/291.ply',
            './models/objaverse/314.ply',
            './models/objaverse/309.ply',
            './models/objaverse/310.ply'
        ];
        
        let currentPage = 1;
        let wireframeEnabled = false;
        
        // Function to handle wireframe toggle with G key
        window.addEventListener('keydown', function(event) {
            if (event.key === 'g' || event.key === 'G') {
                wireframeEnabled = !wireframeEnabled;
                
                // Apply to all visible meshes
                for (let i = 1; i <= 16; i++) {
                    const divId = "mesh_" + i;
                    if (div_to_scene[divId] && div_to_scene[divId].scene) {
                        div_to_scene[divId].scene.traverse(function(child) {
                            if (child instanceof THREE.Mesh) {
                                child.material.wireframe = wireframeEnabled;
                            }
                        });
                    }
                }
            } else if (event.key === 'r' || event.key === 'R') {
                // Reset camera views
                list_of_orbit_controls.forEach(control => {
                    control.reset();
                });
            }
        });
        
        // Main function to setup a render div with a 3D model
        window.setup_render_divs = function(div_id, model_path) {
            const div = document.getElementById(div_id);
            if (!div) return;
            
            // Create a scene
            const scene = new THREE.Scene();
            scene.background = new THREE.Color(0xf0f0f0);
            
            // Setup camera
            const camera = new THREE.PerspectiveCamera(75, div.clientWidth / div.clientHeight, 0.1, 1000);
            camera.position.z = 2;
            
            // Setup renderer
            const renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(div.clientWidth, div.clientHeight);
            div.appendChild(renderer.domElement);
            
            // Add lights
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
            scene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
            directionalLight.position.set(0, 1, 1).normalize();
            scene.add(directionalLight);
            
            // Add orbit controls
            const controls = new OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.25;
            controls.screenSpacePanning = false;
            controls.maxPolarAngle = Math.PI;
            controls.minDistance = 1;
            controls.maxDistance = 10;
            list_of_orbit_controls.push(controls);
            
            // Load the PLY model
            const loader = new PLYLoader();
            loader.load(model_path, function(geometry) {
                geometry.computeVertexNormals();
                
                const material = new THREE.MeshStandardMaterial({
                    color: 0x808080,
                    flatShading: false,
                    side: THREE.DoubleSide,
                    wireframe: wireframeEnabled
                });
                
                const mesh = new THREE.Mesh(geometry, material);
                
                // Center the mesh
                geometry.computeBoundingBox();
                const center = new THREE.Vector3();
                geometry.boundingBox.getCenter(center);
                geometry.translate(-center.x, -center.y, -center.z);
                
                // Scale mesh to fit in view
                const box = new THREE.Box3().setFromObject(mesh);
                const size = box.getSize(new THREE.Vector3());
                const maxDim = Math.max(size.x, size.y, size.z);
                const scale = 1.5 / maxDim;
                mesh.scale.set(scale, scale, scale);
                
                scene.add(mesh);
                
                // Store references for later
                div_to_scene[div_id] = {
                    "geo": geometry,
                    "color": material,
                    "scene": scene
                };
                
                // Animation loop
                function animate() {
                    requestAnimationFrame(animate);
                    controls.update();
                    renderer.render(scene, camera);
                }
                animate();
            });
            
            // Handle window resize
            window.addEventListener('resize', function() {
                const width = div.clientWidth;
                const height = div.clientHeight;
                
                camera.aspect = width / height;
                camera.updateProjectionMatrix();
                renderer.setSize(width, height);
            });
        };
        
        // Function to clean up existing meshes when changing pages
        function cleanupMeshes() {
            // Remove orbit controls
            if (list_of_orbit_controls.length > 0) {
                list_of_orbit_controls.forEach(control => {
                    if (control.dispose) {
                        control.dispose();
                    }
                });
                list_of_orbit_controls = [];
            }
            
            for (let i = 1; i <= 16; i++) {
                const divId = "mesh_" + i;
                
                // If there's an existing scene for this div, dispose of it
                if (div_to_scene[divId] && div_to_scene[divId].scene) {
                    const div = document.getElementById(divId);
                    if (div && div.firstChild) {
                        div.removeChild(div.firstChild);
                    }
                    
                    // Reset in our tracking object
                    div_to_scene[divId] = {
                        "geo": null,
                        "color": null,
                        "scene": null
                    };
                }
            }
        }
        
        // Function to load meshes for a page
        function loadMeshesForPage(pageNum) {
            const startIndex = (pageNum - 1) * 16;
            
            for (let i = 1; i <= 16; i++) {
                const modelIndex = startIndex + i - 1;
                if (modelIndex < allModels.length) {
                    setup_render_divs("mesh_" + i, allModels[modelIndex]);
                }
            }
        }
        
        // Function to change pages - make it global
        window.changePage = function(pageNum) {
            if (pageNum === currentPage) return;
            
            // Update current page
            currentPage = pageNum;
            
            // Clean up existing meshes
            cleanupMeshes();
            
            // Load meshes for the new page
            loadMeshesForPage(pageNum);
            
            // Update the page info text
            document.getElementById('page-info').textContent = `Page ${pageNum} of 3`;
            
            // Update button highlighting
            const buttons = document.querySelectorAll('.pagination-controls .button');
            buttons.forEach((button, index) => {
                if (index + 1 === pageNum) {
                    button.classList.add('is-primary');
                } else {
                    button.classList.remove('is-primary');
                }
            });
        };
        
        // When the page loads, initialize the first page
        window.onload = function() {
            let slider = document.getElementsByClassName("slider")[0];
            if (slider) {
                slider.removeAttribute("tabIndex");
            }
            
            loadMeshesForPage(1);
            document.querySelector('.pagination-controls .button').classList.add('is-primary');
        };
    </script>
</body>

</html>